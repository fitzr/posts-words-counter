machine:
  timezone:
    Asia/Tokyo
  services:
    - docker

dependencies:
  pre:
    - docker run -d -p 13306:3306 -e MYSQL_ALLOW_EMPTY_PASSWORD=yes -e MYSQL_DATABASE=stack_test -e MYSQL_USER=test_user mysql:latest
    - go get -t -d -v ./...
    - go build -v
    - mysqladmin -h 127.0.0.1 -P 13306 -u test_user -w ping

test:
  override:
    - go test -v -race ./...